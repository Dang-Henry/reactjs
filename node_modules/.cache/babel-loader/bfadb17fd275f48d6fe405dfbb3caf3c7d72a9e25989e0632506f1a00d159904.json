{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.makeSafe = exports.isSafe = void 0;\nvar FILE_URI_MATCH = /\\/\\/\\//;\nvar INVALID_RELATIVE_URL = /[/\\\\][/\\\\]/;\nvar VALID_PROTOCOLS = ['https:', 'http:'];\nvar DUMMY_HOSTNAME = 'http://test.com';\nfunction isSafe(redirectUrl, _a) {\n  var _b = _a === void 0 ? {} : _a,\n    _c = _b.allowedDomains,\n    allowedDomains = _c === void 0 ? [] : _c,\n    _d = _b.subdomains,\n    subdomains = _d === void 0 ? [] : _d,\n    matchPath = _b.matchPath,\n    requireAbsolute = _b.requireAbsolute,\n    requireSSL = _b.requireSSL;\n  if (FILE_URI_MATCH.test(redirectUrl)) {\n    return false;\n  }\n  if (redirectUrl.startsWith('/')) {\n    if (allowedDomains.length > 0 || subdomains.length > 0 || requireAbsolute || requireSSL) {\n      return false;\n    }\n    if (matchPath) {\n      // Creating a new URL expands the pathname in case of things like `/a/../b`\n      return pathMatches(new URL(redirectUrl, DUMMY_HOSTNAME), redirectUrl, matchPath);\n    }\n    return !INVALID_RELATIVE_URL.test(redirectUrl);\n  }\n  var url;\n  try {\n    url = new URL(redirectUrl);\n  } catch (error) {\n    return false;\n  }\n  if (!VALID_PROTOCOLS.includes(url.protocol)) {\n    return false;\n  }\n  if (requireSSL && url.protocol !== 'https:') {\n    return false;\n  }\n  if (url.username || url.password) {\n    return false;\n  }\n  if (matchPath && !pathMatches(url, redirectUrl, matchPath)) {\n    return false;\n  }\n  if (!hostIsValid(url, allowedDomains, subdomains)) {\n    return false;\n  }\n  return true;\n}\nexports.isSafe = isSafe;\nfunction hostIsValid(url, allowedDomains, subdomains) {\n  if (!subdomains.every(function (subdomain) {\n    return subdomain.startsWith('.');\n  })) {\n    throw new TypeError('Subdomains must begin with .');\n  }\n  var hostname = url.hostname;\n  return allowedDomains.length === 0 && subdomains.length === 0 || allowedDomains.includes(hostname) || subdomains.some(function (subdomain) {\n    return hostname.endsWith(subdomain);\n  });\n}\nfunction pathMatches(url, originalUrl, matcher) {\n  var pathname = url.pathname;\n  // Gets just the unresolve pathname, i.e., `http://foo.com/a/../b => /a/../b\n  var originalPathname = originalUrl.replace(url.origin, '').split('?')[0];\n  return typeof matcher === 'string' ? pathname === matcher && originalPathname === matcher : matcher.test(pathname) && matcher.test(originalPathname);\n}\nfunction makeSafe(url, fallback, options) {\n  return isSafe(url, options) ? encodeURI(url) : fallback;\n}\nexports.makeSafe = makeSafe;","map":{"version":3,"names":["Object","defineProperty","exports","value","makeSafe","isSafe","FILE_URI_MATCH","INVALID_RELATIVE_URL","VALID_PROTOCOLS","DUMMY_HOSTNAME","redirectUrl","_a","_b","_c","allowedDomains","_d","subdomains","matchPath","requireAbsolute","requireSSL","test","startsWith","length","pathMatches","URL","url","error","includes","protocol","username","password","hostIsValid","every","subdomain","TypeError","hostname","some","endsWith","originalUrl","matcher","pathname","originalPathname","replace","origin","split","fallback","options","encodeURI"],"sources":["/Users/huandang/Documents/1.Develop/1.1.ProjectGithub/reactjs/node_modules/@shopify/app-bridge/validate/safe-redirect.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.makeSafe = exports.isSafe = void 0;\nvar FILE_URI_MATCH = /\\/\\/\\//;\nvar INVALID_RELATIVE_URL = /[/\\\\][/\\\\]/;\nvar VALID_PROTOCOLS = ['https:', 'http:'];\nvar DUMMY_HOSTNAME = 'http://test.com';\nfunction isSafe(redirectUrl, _a) {\n    var _b = _a === void 0 ? {} : _a, _c = _b.allowedDomains, allowedDomains = _c === void 0 ? [] : _c, _d = _b.subdomains, subdomains = _d === void 0 ? [] : _d, matchPath = _b.matchPath, requireAbsolute = _b.requireAbsolute, requireSSL = _b.requireSSL;\n    if (FILE_URI_MATCH.test(redirectUrl)) {\n        return false;\n    }\n    if (redirectUrl.startsWith('/')) {\n        if (allowedDomains.length > 0 || subdomains.length > 0 || requireAbsolute || requireSSL) {\n            return false;\n        }\n        if (matchPath) {\n            // Creating a new URL expands the pathname in case of things like `/a/../b`\n            return pathMatches(new URL(redirectUrl, DUMMY_HOSTNAME), redirectUrl, matchPath);\n        }\n        return !INVALID_RELATIVE_URL.test(redirectUrl);\n    }\n    var url;\n    try {\n        url = new URL(redirectUrl);\n    }\n    catch (error) {\n        return false;\n    }\n    if (!VALID_PROTOCOLS.includes(url.protocol)) {\n        return false;\n    }\n    if (requireSSL && url.protocol !== 'https:') {\n        return false;\n    }\n    if (url.username || url.password) {\n        return false;\n    }\n    if (matchPath && !pathMatches(url, redirectUrl, matchPath)) {\n        return false;\n    }\n    if (!hostIsValid(url, allowedDomains, subdomains)) {\n        return false;\n    }\n    return true;\n}\nexports.isSafe = isSafe;\nfunction hostIsValid(url, allowedDomains, subdomains) {\n    if (!subdomains.every(function (subdomain) { return subdomain.startsWith('.'); })) {\n        throw new TypeError('Subdomains must begin with .');\n    }\n    var hostname = url.hostname;\n    return ((allowedDomains.length === 0 && subdomains.length === 0) ||\n        allowedDomains.includes(hostname) ||\n        subdomains.some(function (subdomain) { return hostname.endsWith(subdomain); }));\n}\nfunction pathMatches(url, originalUrl, matcher) {\n    var pathname = url.pathname;\n    // Gets just the unresolve pathname, i.e., `http://foo.com/a/../b => /a/../b\n    var originalPathname = originalUrl.replace(url.origin, '').split('?')[0];\n    return typeof matcher === 'string'\n        ? pathname === matcher && originalPathname === matcher\n        : matcher.test(pathname) && matcher.test(originalPathname);\n}\nfunction makeSafe(url, fallback, options) {\n    return isSafe(url, options) ? encodeURI(url) : fallback;\n}\nexports.makeSafe = makeSafe;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}