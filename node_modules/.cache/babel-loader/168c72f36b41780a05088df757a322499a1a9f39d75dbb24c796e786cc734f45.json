{"ast":null,"code":"\"use strict\";\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.ActionType = exports.validateAction = exports.validateProps = void 0;\nvar type_validate_1 = require(\"../type-validate\");\nvar utils_1 = require(\"../utils\");\nvar Modal_1 = require(\"../../actions/Modal\");\nObject.defineProperty(exports, \"ActionType\", {\n  enumerable: true,\n  get: function () {\n    return Modal_1.ActionType;\n  }\n});\nvar Button_1 = require(\"../../actions/Button\");\nvar safe_redirect_1 = require(\"../safe-redirect\");\nvar button_1 = require(\"./button\");\nfunction matchesSafeOrigin(value, localOrigin) {\n  var hostName;\n  try {\n    hostName = new URL(localOrigin).hostname;\n  } catch (error) {\n    return [{\n      error: 'invalid_app_origin',\n      value: localOrigin,\n      message: \"Provided value for app origin: `\" + localOrigin + \"` is invalid\"\n    }];\n  }\n  var isSafeSrc = safe_redirect_1.isSafe(value, {\n    requireAbsolute: true,\n    requireSSL: true,\n    allowedDomains: [hostName]\n  });\n  if (!isSafeSrc) {\n    return [{\n      error: 'not_matching_app_origin',\n      value: value,\n      message: \"Provided URL origin does not match app origin `\" + hostName + \"`\"\n    }];\n  }\n}\nfunction matchesSize() {\n  return function (value) {\n    var values = [Modal_1.Size.Small, Modal_1.Size.Medium, Modal_1.Size.Large];\n    if (values.includes(value)) {\n      return;\n    }\n    var message = \"expected:\" + values.map(function (val) {\n      return \"`\" + val + \"`\";\n    }).join(' or ');\n    if (value === Modal_1.Size.Full) {\n      message += \". Size `\" + value + \"` is deprecated as of version 1.6.5 and will fall back to size `medium`\";\n    }\n    if (value === Modal_1.Size.Auto) {\n      message += \". Size `\" + value + \"` is deprecated as of version 1.12.x and will fall back to size `medium`. Use the `setUpModalAutoSizing` utility from `app-bridge-utils` instead\";\n    }\n    return [{\n      error: 'invalid_enum_value',\n      value: value,\n      message: message\n    }];\n  };\n}\nfunction getModalSchema(props, localOrigin) {\n  if (props === void 0) {\n    props = {};\n  }\n  var baseModalSchema = type_validate_1.matchesObject({\n    title: type_validate_1.makeOptional(type_validate_1.matchesString()),\n    footer: type_validate_1.makeOptional(type_validate_1.matchesObject({\n      buttons: type_validate_1.matchesObject({\n        primary: type_validate_1.makeOptional(button_1.buttonSchemaWithId),\n        secondary: type_validate_1.makeOptional(type_validate_1.matchesArray(button_1.buttonSchemaWithId))\n      })\n    })),\n    size: type_validate_1.makeOptional(matchesSize())\n  });\n  if (Modal_1.isIframeModal(props)) {\n    if (props.url) {\n      var urlSchema = type_validate_1.matchesObject({\n        url: type_validate_1.composeSchemas(type_validate_1.matchesString(), function (value) {\n          return value.startsWith('https://') ? undefined : [{\n            error: 'invalid_secure_url',\n            value: value,\n            message: 'expected string to start with `https://`'\n          }];\n        }, function (value) {\n          return localOrigin ? matchesSafeOrigin(value, localOrigin) : undefined;\n        })\n      });\n      return type_validate_1.composeSchemas(baseModalSchema, urlSchema);\n    }\n    return type_validate_1.composeSchemas(baseModalSchema, utils_1.relativePathSchema);\n  }\n  return type_validate_1.composeSchemas(baseModalSchema, type_validate_1.matchesObject({\n    message: type_validate_1.matchesString()\n  }));\n}\nfunction validateProps(props, localOrigin) {\n  return type_validate_1.validate(props, getModalSchema(props, localOrigin));\n}\nexports.validateProps = validateProps;\nfunction validateAction(action, localOrigin) {\n  var schema = getModalSchema(action.payload, localOrigin);\n  switch (action.type) {\n    case Modal_1.ActionType.OPEN:\n    case Modal_1.ActionType.UPDATE:\n      return type_validate_1.validate(action, utils_1.createActionValidator(Modal_1.ActionType, schema, true, action.type === Modal_1.ActionType.UPDATE));\n    case Modal_1.ActionType.FOOTER_BUTTON_CLICK:\n      return button_1.validateAction(__assign(__assign({}, action), {\n        type: Button_1.ActionType.CLICK\n      }));\n    case Modal_1.ActionType.FOOTER_BUTTON_UPDATE:\n      return button_1.validateAction(__assign(__assign({}, action), {\n        type: Button_1.ActionType.UPDATE\n      }));\n    case Modal_1.ActionType.CLOSE:\n    default:\n      return type_validate_1.validate(action, utils_1.createActionValidator(Modal_1.ActionType));\n  }\n}\nexports.validateAction = validateAction;","map":{"version":3,"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","defineProperty","exports","value","ActionType","validateAction","validateProps","type_validate_1","require","utils_1","Modal_1","enumerable","get","Button_1","safe_redirect_1","button_1","matchesSafeOrigin","localOrigin","hostName","URL","hostname","error","message","isSafeSrc","isSafe","requireAbsolute","requireSSL","allowedDomains","matchesSize","values","Size","Small","Medium","Large","includes","map","val","join","Full","Auto","getModalSchema","props","baseModalSchema","matchesObject","title","makeOptional","matchesString","footer","buttons","primary","buttonSchemaWithId","secondary","matchesArray","size","isIframeModal","url","urlSchema","composeSchemas","startsWith","undefined","relativePathSchema","validate","action","schema","payload","type","OPEN","UPDATE","createActionValidator","FOOTER_BUTTON_CLICK","CLICK","FOOTER_BUTTON_UPDATE","CLOSE"],"sources":["/Users/huandang/Documents/1.Develop/1.1.ProjectGithub/reactjs/node_modules/@shopify/app-bridge/validate/actions/modal.js"],"sourcesContent":["\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ActionType = exports.validateAction = exports.validateProps = void 0;\nvar type_validate_1 = require(\"../type-validate\");\nvar utils_1 = require(\"../utils\");\nvar Modal_1 = require(\"../../actions/Modal\");\nObject.defineProperty(exports, \"ActionType\", { enumerable: true, get: function () { return Modal_1.ActionType; } });\nvar Button_1 = require(\"../../actions/Button\");\nvar safe_redirect_1 = require(\"../safe-redirect\");\nvar button_1 = require(\"./button\");\nfunction matchesSafeOrigin(value, localOrigin) {\n    var hostName;\n    try {\n        hostName = new URL(localOrigin).hostname;\n    }\n    catch (error) {\n        return [\n            {\n                error: 'invalid_app_origin',\n                value: localOrigin,\n                message: \"Provided value for app origin: `\" + localOrigin + \"` is invalid\",\n            },\n        ];\n    }\n    var isSafeSrc = safe_redirect_1.isSafe(value, {\n        requireAbsolute: true,\n        requireSSL: true,\n        allowedDomains: [hostName],\n    });\n    if (!isSafeSrc) {\n        return [\n            {\n                error: 'not_matching_app_origin',\n                value: value,\n                message: \"Provided URL origin does not match app origin `\" + hostName + \"`\",\n            },\n        ];\n    }\n}\nfunction matchesSize() {\n    return function (value) {\n        var values = [Modal_1.Size.Small, Modal_1.Size.Medium, Modal_1.Size.Large];\n        if (values.includes(value)) {\n            return;\n        }\n        var message = \"expected:\" + values.map(function (val) { return \"`\" + val + \"`\"; }).join(' or ');\n        if (value === Modal_1.Size.Full) {\n            message += \". Size `\" + value + \"` is deprecated as of version 1.6.5 and will fall back to size `medium`\";\n        }\n        if (value === Modal_1.Size.Auto) {\n            message += \". Size `\" + value + \"` is deprecated as of version 1.12.x and will fall back to size `medium`. Use the `setUpModalAutoSizing` utility from `app-bridge-utils` instead\";\n        }\n        return [\n            {\n                error: 'invalid_enum_value',\n                value: value,\n                message: message,\n            },\n        ];\n    };\n}\nfunction getModalSchema(props, localOrigin) {\n    if (props === void 0) { props = {}; }\n    var baseModalSchema = type_validate_1.matchesObject({\n        title: type_validate_1.makeOptional(type_validate_1.matchesString()),\n        footer: type_validate_1.makeOptional(type_validate_1.matchesObject({\n            buttons: type_validate_1.matchesObject({\n                primary: type_validate_1.makeOptional(button_1.buttonSchemaWithId),\n                secondary: type_validate_1.makeOptional(type_validate_1.matchesArray(button_1.buttonSchemaWithId)),\n            }),\n        })),\n        size: type_validate_1.makeOptional(matchesSize()),\n    });\n    if (Modal_1.isIframeModal(props)) {\n        if (props.url) {\n            var urlSchema = type_validate_1.matchesObject({\n                url: type_validate_1.composeSchemas(type_validate_1.matchesString(), function (value) {\n                    return value.startsWith('https://')\n                        ? undefined\n                        : [\n                            {\n                                error: 'invalid_secure_url',\n                                value: value,\n                                message: 'expected string to start with `https://`',\n                            },\n                        ];\n                }, function (value) { return (localOrigin ? matchesSafeOrigin(value, localOrigin) : undefined); }),\n            });\n            return type_validate_1.composeSchemas(baseModalSchema, urlSchema);\n        }\n        return type_validate_1.composeSchemas(baseModalSchema, utils_1.relativePathSchema);\n    }\n    return type_validate_1.composeSchemas(baseModalSchema, type_validate_1.matchesObject({ message: type_validate_1.matchesString() }));\n}\nfunction validateProps(props, localOrigin) {\n    return type_validate_1.validate(props, getModalSchema(props, localOrigin));\n}\nexports.validateProps = validateProps;\nfunction validateAction(action, localOrigin) {\n    var schema = getModalSchema(action.payload, localOrigin);\n    switch (action.type) {\n        case Modal_1.ActionType.OPEN:\n        case Modal_1.ActionType.UPDATE:\n            return type_validate_1.validate(action, utils_1.createActionValidator(Modal_1.ActionType, schema, true, action.type === Modal_1.ActionType.UPDATE));\n        case Modal_1.ActionType.FOOTER_BUTTON_CLICK:\n            return button_1.validateAction(__assign(__assign({}, action), { type: Button_1.ActionType.CLICK }));\n        case Modal_1.ActionType.FOOTER_BUTTON_UPDATE:\n            return button_1.validateAction(__assign(__assign({}, action), { type: Button_1.ActionType.UPDATE }));\n        case Modal_1.ActionType.CLOSE:\n        default:\n            return type_validate_1.validate(action, utils_1.createActionValidator(Modal_1.ActionType));\n    }\n}\nexports.validateAction = validateAction;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}